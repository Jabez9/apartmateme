{% extends 'layout.html' %}
{% load static %}
{% block body %}
            <!-- Header Start -->
            <div class="container-fluid bg-breadcrumb">
              <div class="container text-center py-5" style="max-width: 900px;">
                  <h4 class="text-white display-4 mb-4 wow animate__animated animate__fadeInDown" data-wow-delay="0.1s" style="font-weight: bolder;"> Bedsitters</h4>
                  <ol class="breadcrumb d-flex justify-content-center mb-0 wow fadeInDown" data-wow-delay="0.3s">
                      <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                      <li class="breadcrumb-item active text-danger">Bedsitters</li>
                  </ol>
              </div>
        
          <!-- Header End -->
        
          <!-- Initialize WOW.js -->
          <script>
              new WOW().init(); // Initialize WOW.js
          </script>

        

        <div class="container">

        <h3 style="color: rgb(255, 255, 255); text-align: center;">Here is our range of bed sitter listings</h3>

         </div>
        
       
      </div>




      <section style="background-color: rgb(243, 246, 248);">
        <!-- Featured Services Section -->
        <section id="featured-services" class="featured-services section" style="margin: 0 auto; max-width: 80%; overflow: hidden;">
            <div id="no-results-message" class="text-center text-danger mt-3" style="display: none;">
                <h5>Sorry, no houses meet your criteria.</h5>
            </div>
            <div class="row row-cols-1 row-cols-md-3 g-4">
                {% for house in houses %}
                <div class="col">
                    <div class="cardhouse h-100">
                        <div class="bedsitter-image-container position-relative">
                            <button class="btn btn-sm btn-success position-absolute top-0 start-0 m-2" style="z-index: 10;">
                                {{ house.status }}
                            </button>
                            <img src="{{ house.main_image.url }}" class="card-img-top" alt="{{ house.name }}" />
                        </div>
                         <br>
                        <div class="card-footer">
                            <!-- House Name -->
                            <h4 class="card-title" style="color: rgba(6, 79, 175, 0.856); font-weight: bold;">{{ house.name }}</h4>
                            
                            <!-- Location (SVG for location icon) -->
                            <h5>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt" viewBox="0 0 16 16">
                                    <path d="M8 0a4 4 0 0 1 4 4c0 2.25-1.35 4.24-2.86 5.74l-1.14 1.25-1.14-1.25C5.35 8.24 4 6.25 4 4A4 4 0 0 1 8 0zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                                </svg>
                                <span style="color: grey;">{{ house.location }}</span>
                            </h5>
                            
                            <!-- Rent Prices (Dark Green and Bold) -->
                            <h5>
                                <ul>
                                    {% for rent_item in house.rent %}
                                        <li style="color: rgb(29, 136, 8); font-weight: bold;">KSh {{ rent_item }}</li>
                                    {% empty %}
                                        <li style="color: grey;">No rent information available</li>
                                    {% endfor %}
                                </ul>
                            </h5>
                        
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#bedsitter{{ house.id }}">Details</button>
                        </div>
                        
                    </div>
                </div>
            
                <!-- Modal for Card -->
                <div class="modal fade" id="bedsitter{{ house.id }}" tabindex="-1" aria-labelledby="detailsModal{{ house.id }}Label" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="detailsModal{{ house.id }}Label"> <b><strong>{{ house.name }} Details</strong></b></h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="text-center mt-3">
                                    <!-- Call Agent Button -->
                                    <a href="tel:+254791751475" class="btn btn-success">Request Visit or Booking</a>
                                </div>
                                <h6>Location: {{ house.location }}</h6>
                                <p>Description: {{ house.description }}</p>
                                <br>
                                <p>Pros:
                                <ul>
                                    {{ house.pros }}
                                </ul>
                                </p>
                                <h6>Gallery:</h6>
                                <div class="row">
                                    {% for image in house.images.all %}
                                        <div class="col-md-4">
                                            <img src="{{ image.image.url }}" alt="House Image" class="img-fluid" />
                                        </div>
                                    {% endfor %}
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>


        <script>
         // Function to filter the house cards dynamically
         function applyFilters() {
             const locationFilter = document.getElementById('location-filter').value;
             const priceFilter = document.getElementById('price-filter').value;
             const nameSearch = document.getElementById('name-search').value.toLowerCase();
       
             // Get all house cards
             const houseCards = document.querySelectorAll('.cardhouse');
       
             let anyMatch = false; // To track if any card matches the filters
       
             houseCards.forEach(card => {
                 const cardLocation = card.querySelector('h6:nth-child(2)').textContent.split(': ')[1];
                 const cardPrices = Array.from(card.querySelectorAll('h6'))
                     .slice(1)
                     .map(h6 => h6.textContent.replace(/\D/g, ''));
                 const cardName = card.querySelector('.card-title').textContent.toLowerCase();
       
                 let matchesLocation = !locationFilter || cardLocation === locationFilter;
                 let matchesPrice = !priceFilter || cardPrices.includes(priceFilter);
                 let matchesName = !nameSearch || cardName.includes(nameSearch);
       
                 // Show or hide the card based on filters
                 if (matchesLocation && matchesPrice && matchesName) {
                     card.parentElement.style.display = 'block';
                     anyMatch = true;
                 } else {
                     card.parentElement.style.display = 'none';
                 }
             });
       
             // Show or hide "no results" message
             const noResultsMessage = document.getElementById('no-results-message');
             if (anyMatch) {
                 noResultsMessage.style.display = 'none';
             } else {
                 noResultsMessage.style.display = 'block';
             }
         }
       
         // Event listeners for dynamic filtering
         document.getElementById('location-filter').addEventListener('change', applyFilters);
         document.getElementById('price-filter').addEventListener('change', applyFilters);
         document.getElementById('name-search').addEventListener('input', applyFilters);
       
         // Clear filters and show all cards
         document.getElementById('clear-filters').addEventListener('click', function () {
             // Reset filter dropdowns and search bar
             document.getElementById('location-filter').value = '';
             document.getElementById('price-filter').value = '';
             document.getElementById('name-search').value = '';
       
             // Show all house cards
             const houseCards = document.querySelectorAll('.cardhouse');
             houseCards.forEach(card => {
                 card.parentElement.style.display = 'block';
             });
       
             // Hide the "no results" message
             const noResultsMessage = document.getElementById('no-results-message');
             noResultsMessage.style.display = 'none';
         });
       </script>
       
       
       
         </section>
       </section>
       
       
       
       
       
       {% endblock %}