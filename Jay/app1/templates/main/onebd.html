{% extends 'layout.html' %}
{% load static %}
{% block body %}
            <!-- Header Start -->
            <div class="container-fluid bg-breadcrumb">
              <div class="container text-center py-5" style="max-width: 900px;">
                  <h4 class="text-white display-4 mb-4 wow animate__animated animate__fadeInDown" data-wow-delay="0.1s" style="font-weight: bolder;"> One Bedroom</h4>
                  <ol class="breadcrumb d-flex justify-content-center mb-0 wow fadeInDown" data-wow-delay="0.3s">
                      <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                      <li class="breadcrumb-item active text-danger">One Bedroom</li>
                  </ol>
              </div>
        
          <!-- Header End -->
        
          <!-- Initialize WOW.js -->
          <script>
              new WOW().init(); // Initialize WOW.js
          </script>

        

        <div class="container">

        <h3 style="color: rgb(255, 255, 255); text-align: center;">Here is our range of one bedroom  listings</h3>

         </div>
        
       
</div>

<!-- 
<section style="background-color: silver; padding: 20px;">
  
  <div class="d-flex justify-content-between align-items-start mb-4">
   
    <div>
        <div class="d-flex gap-3">
           
            <select id="location-filter" class="form-control mb-2" style="width: 200px;">
                <option value="" selected disabled>Select Location</option>
                <option value="Ole Kasasi A">Ole Kasasi A</option>
                <option value="Tumaini">Tumaini</option>
                <option value="Ole Kasasi B">Ole Kasasi B</option>
                <option value="Sironik">Sironik</option>
                <option value="Mayor Road">Mayor Road</option>
                <option value="Masai Lodge Road">Masai Lodge Road</option>
                <option value="Naivas">Naivas</option>
                <option value="Gataka Road">Gataka Road</option>
                <option value="Mandazi Road">Mandazi Road</option>
            </select>

           
            <select id="price-filter" class="form-control mb-2" style="width: 200px;">
                <option value="" selected disabled>Select Price</option>
                <option value="8500">Ksh 8500</option>
                <option value="9000">KSh 9000</option>
                <option value="10000">KSh 10000</option>
                <option value="11000">KSh 11000</option>
                <option value="12000">KSh 12000</option>
                <option value="">Ksh 20000</option>
                <option value="">Ksh 21000</option>
                <option value="">Ksh 22000</option>
                <option value="">Ksh 23000</option>
                <option value="24000"> Ksh 24000</option>
            </select>
        </div>

        <input id="name-search" class="form-control mb-2 me-2" style="width: 200px;" type="text" placeholder="Search by Name">
      </div>

      
        <div class="mt-3 d-flex gap-3">
            <button id="apply-filters" class="btn btn-primary">Search</button>
            <button id="clear-filters" class="btn btn-danger">Clear</button>
        </div>

      
      
    </div>
</div>




</section> -->



<!-- <div class="container"> -->

<!-- Featured Services Section -->
<section id="featured-services" class="featured-services section"  style="margin: 0 auto; max-width: 80%; padding: 20px 0; height: auto; overflow: hidden;">

  <div id="no-results-message" class="text-center text-danger mt-3" style="display: none;">
    <h5>Sorry, no houses currently meet your criteria.</h5>
</div>

<div class="row row-cols-1 row-cols-md-3 g-4">
    {% for house in houses %}
    <div class="col">
        <div class="cardhouse h-100">
            <div class="bedsitter-image-container position-relative">
                <button class="btn btn-sm btn-success position-absolute top-0 start-0 m-2" style="z-index: 10;">
                    {{ house.status }}
                </button>
                <img src="{{ house.main_image.url }}" class="card-img-top" alt="{{ house.name }}" />
            </div>
             <br>
            <div class="card-footer">
                <!-- House Name -->
                <h4 class="card-title" style="color: rgba(6, 79, 175, 0.856); font-weight: bold;">{{ house.name }}</h4>
                
                <!-- Location (SVG for location icon) -->
                <h5>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt" viewBox="0 0 16 16">
                        <path d="M8 0a4 4 0 0 1 4 4c0 2.25-1.35 4.24-2.86 5.74l-1.14 1.25-1.14-1.25C5.35 8.24 4 6.25 4 4A4 4 0 0 1 8 0zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                    </svg>
                    <span style="color: grey;">{{ house.location }}</span>
                </h5>
                
                <!-- Rent Prices (Dark Green and Bold) -->
                <h5>
                    <ul>
                        {% for rent_item in house.rent %}
                            <li style="color: rgb(29, 136, 8); font-weight: bold;">KSh {{ rent_item }}</li>
                        {% empty %}
                            <li style="color: grey;">No rent information available</li>
                        {% endfor %}
                    </ul>
                </h5>
            
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#onebd{{ house.id }}">Details</button>
            </div>
            
        </div>
    </div>

    <!-- Modal for Card -->
    <div class="modal fade" id="onebd{{ house.id }}" tabindex="-1" aria-labelledby="detailsModal{{ house.id }}Label" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detailsModal{{ house.id }}Label"> <b><strong>{{ house.name }} Details</strong></b></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mt-3">
                        <!-- Call Agent Button -->
                        <a href="tel:+254791751475" class="btn btn-success">Request Visit or Booking</a>
                    </div>
                    <h6>Location: {{ house.location }}</h6>
                    <p>Description: {{ house.description }}</p>
                    <br>
                    <p>Pros:
                    <ul>
                        {{ house.pros }}
                    </ul>
                    </p>
                    <h6>Gallery:</h6>
                    <div class="row">
                        {% for image in house.images.all %}
                            <div class="col-md-4">
                                <img src="{{ image.image.url }}" alt="House Image" class="img-fluid" />
                            </div>
                        {% endfor %}
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

    

      </div>
    </div>
  </div>
  </section>







  <script>
    document.getElementById('apply-filters').addEventListener('click', function () {
      const locationFilter = document.getElementById('location-filter').value;
      const priceFilter = document.getElementById('price-filter').value;
      const nameSearch = document.getElementById('name-search').value.toLowerCase();
  
      // Get all house cards
      const houseCards = document.querySelectorAll('.cardhouse');
  
      let anyMatch = false; // To track if any card matches the filters
  
      houseCards.forEach(card => {
          const cardLocation = card.querySelector('h6:nth-child(2)').textContent.split(': ')[1];
          const cardPrices = Array.from(card.querySelectorAll('h6')).slice(1).map(h6 => h6.textContent.replace(/\D/g, ''));
          const cardName = card.querySelector('.card-title').textContent.toLowerCase();
  
          let matchesLocation = !locationFilter || cardLocation === locationFilter;
          let matchesPrice = !priceFilter || cardPrices.includes(priceFilter);
          let matchesName = !nameSearch || cardName.includes(nameSearch);
  
          // Show or hide the card based on filters
          if (matchesLocation && matchesPrice && matchesName) {
              card.parentElement.style.display = 'block';
              anyMatch = true;
          } else {
              card.parentElement.style.display = 'none';
          }
      });
  
      // Show or hide "no results" message
      const noResultsMessage = document.getElementById('no-results-message');
      if (anyMatch) {
          noResultsMessage.style.display = 'none';
      } else {
          noResultsMessage.style.display = 'block';
      }
  });
  
  document.getElementById('clear-filters').addEventListener('click', function () {
      // Reset filter dropdowns and search bar
      document.getElementById('location-filter').value = '';
      document.getElementById('price-filter').value = '';
      document.getElementById('name-search').value = '';
  
      // Show all house cards
      const houseCards = document.querySelectorAll('.cardhouse');
      houseCards.forEach(card => {
          card.parentElement.style.display = 'block';
      });
  
      // Hide the "no results" message
      const noResultsMessage = document.getElementById('no-results-message');
      noResultsMessage.style.display = 'none';
  });
  
   </script>
  






{% endblock %}